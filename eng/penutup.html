<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penutup & Bonus</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Menambahkan Font dari Google Fonts untuk desain sertifikat -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@400;600&family=Tangerine:wght@700&display=swap" rel="stylesheet">
    <!-- Menambahkan library html2canvas dan SweetAlert2 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
        }
        .lesson-card {
            scroll-margin-top: 80px;
        }
        /* Wrapper untuk membuat sertifikat responsif di layar */
        #certificate-wrapper {
            width: 100%;
            max-width: 1123px; /* Lebar A4 Lanskap */
            margin: auto;
            border: 1px solid #ddd;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden; /* Menjaga agar dekorasi tidak keluar */
        }
        /* Desain Sertifikat Baru (Lanskap) */
        #certificate {
            width: 1123px; /* A4 width (landscape) */
            height: 794px; /* A4 height (landscape) */
            padding: 60px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #ffffff;
            position: relative;
            overflow: hidden; /* Penting untuk menampung elemen absolut */
        }
        .font-montserrat { font-family: 'Montserrat', sans-serif; }
        .font-tangerine { font-family: 'Tangerine', cursive; }
        .input-group {
            margin-bottom: 1rem;
        }
        .input-group label {
            display: block;
            text-align: left;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        .input-group input {
            width: 100%;
        }
        /* Elemen Dekoratif */
        .deco-shape {
            position: absolute;
            background-color: #1e3a8a; /* Dark Blue */
        }
        .deco-shape-light {
            background-color: #60a5fa; /* Light Blue */
        }
        /* Top Left */
        .tl-1 { top: -50px; left: 80px; width: 200px; height: 100px; transform: skewX(-45deg); }
        .tl-2 { top: 0px; left: -80px; width: 200px; height: 120px; transform: skewX(-45deg); }
        /* Top Right */
        .tr-1 { top: 80px; right: -80px; width: 200px; height: 100px; transform: skewX(-45deg); }
        .tr-2 { top: -40px; right: 50px; width: 200px; height: 100px; transform: skewX(-45deg); }
         /* Bottom Left */
        .bl-1 { bottom: -50px; left: 80px; width: 200px; height: 100px; transform: skewX(-45deg); }
        .bl-2 { bottom: 0px; left: -80px; width: 200px; height: 120px; transform: skewX(-45deg); }
        /* Bottom Right */
        .br-1 { bottom: 80px; right: -80px; width: 200px; height: 100px; transform: skewX(-45deg); }
        .br-2 { bottom: -40px; right: 50px; width: 200px; height: 100px; transform: skewX(-45deg); }
        
        /* CSS untuk mencetak */
        @media print {
            .no-print {
                display: none !important;
            }
            body {
                background-color: #fff;
                margin: 0;
            }
            #certificate-wrapper {
                border: none;
                box-shadow: none;
                margin: 0 auto;
                max-width: 100%;
            }
            #certificate {
                width: 100%;
                height: auto;
                transform: scale(1);
            }
        }
    </style>
</head>
<body class="text-gray-800">

    <header class="bg-white/80 backdrop-blur-lg shadow-md sticky top-0 z-50 no-print">
        <div class="container mx-auto p-4 flex justify-between items-center">
            <h1 class="text-xl md:text-2xl font-bold text-blue-600">üèÅ Penutup & Bonus</h1>
            <a href="index.html" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                &larr; Kembali ke Menu
            </a>
        </div>
    </header>

    <main class="container mx-auto p-6 md:p-10">
        
        <section id="bonus-31" class="lesson-card bg-white p-6 md:p-8 rounded-2xl shadow-lg mb-8 no-print">
            <h2 class="text-2xl font-bold text-blue-700 mb-4">31. Evaluasi Interaktif (Terjemahkan Kata) üéÆ</h2>
            <div id="game-container" class="text-center bg-gray-100 p-6 rounded-lg">
                <p class="text-lg mb-2">Terjemahkan kata ini:</p>
                <div id="clue-word" class="mb-4 text-4xl font-bold text-blue-800 p-4 h-24 flex items-center justify-center">[Kata]</div>
                <input type="text" id="answer-input" placeholder="Tulis jawabanmu di sini..." class="w-full max-w-sm p-2 border-2 border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
                <button id="check-btn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg mt-2 hover:bg-blue-700 transition-colors">Cek Jawaban</button>
                <p id="feedback-message" class="mt-4 font-semibold h-6"></p>
                <button id="next-btn" class="hidden bg-green-500 text-white font-bold py-2 px-6 rounded-lg mt-2 hover:bg-green-600 transition-colors">Soal Berikutnya</button>
            </div>
        </section>

        <section id="bonus-32" class="lesson-card bg-white p-6 md:p-8 rounded-2xl shadow-lg mb-8">
            <h2 class="text-2xl font-bold text-blue-700 mb-4 no-print">32. Sertifikat Penghargaan üèÜ</h2>
            
            <div class="bg-gray-100 p-6 rounded-lg mb-4 grid grid-cols-1 md:grid-cols-2 gap-x-6 no-print">
                <div class="input-group">
                    <label for="student-name-input">Nama Murid:</label>
                    <input type="text" id="student-name-input" class="p-2 border rounded-md" placeholder="Contoh: Budi">
                </div>
                <div class="input-group">
                    <label for="school-name-input">Nama Sekolah:</label>
                    <input type="text" id="school-name-input" class="p-2 border rounded-md" placeholder="Contoh: SDN 1 Merdeka">
                </div>
                 <div class="input-group">
                    <label for="headmaster-name-input">Nama Kepala Sekolah:</label>
                    <input type="text" id="headmaster-name-input" class="p-2 border rounded-md" placeholder="Contoh: Drs. Ahmad">
                </div>
                <div class="input-group">
                    <label for="teacher-name-input">Nama Guru:</label>
                    <input type="text" id="teacher-name-input" class="p-2 border rounded-md" placeholder="Contoh: Siti, S.Pd.">
                </div>
                <div class="md:col-span-2 text-center mt-4">
                     <button id="generate-cert-btn" class="bg-blue-600 text-white py-2 px-6 rounded-md">Terapkan ke Sertifikat</button>
                </div>
            </div>

            <div id="certificate-wrapper">
                <div id="certificate" class="text-gray-800">
                    <div class="deco-shape tl-1"></div>
                    <div class="deco-shape deco-shape-light tl-2"></div>
                    <div class="deco-shape tr-1"></div>
                    <div class="deco-shape deco-shape-light tr-2"></div>
                    <div class="deco-shape bl-1"></div>
                    <div class="deco-shape deco-shape-light bl-2"></div>
                    <div class="deco-shape br-1"></div>
                    <div class="deco-shape deco-shape-light br-2"></div>
                    
                    <div class="text-center z-10 mt-24">
                        <h1 class="font-montserrat font-bold text-6xl tracking-wider text-blue-900">SERTIFIKAT</h1>
                        <p class="font-montserrat text-2xl mt-2 text-gray-600">PENGHARGAAN</p>
                        
                        <p class="mt-20 text-xl">Dengan bangga diberikan kepada:</p>
                        
                        <p id="cert-student-name" class="font-tangerine text-9xl my-4 text-blue-800">[ Nama Murid ]</p>
                        
                        <p class="mt-12 text-lg w-3/4 mx-auto">
                           Atas keberhasilannya menyelesaikan program pembelajaran<br>
                           <span class="font-bold">"English for Kids Fun Learning"</span><br>
                           <span class="text-base">dari <span id="cert-school-name" class="font-semibold">[ Nama Sekolah ]</span></span>
                        </p>
                    </div>

                    <div class="w-full flex justify-between items-end absolute bottom-10 left-0 px-24 mt-auto z-10">
                        <div class="text-center">
                            <p id="cert-headmaster-name" class="font-montserrat font-bold">[ Nama Kepala Sekolah ]</p>
                            <div class="w-56 h-px bg-gray-600 mt-1"></div>
                            <p class="text-sm">Kepala Sekolah</p>
                        </div>
                        <div class="text-center">
                            <p id="cert-teacher-name" class="font-montserrat font-bold">[ Nama Guru ]</p>
                            <div class="w-56 h-px bg-gray-600 mt-1"></div>
                            <p class="text-sm">Guru Pembimbing</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex flex-col md:flex-row md:space-x-4 mt-4 no-print">
                <button id="download-cert-btn" class="flex-1 bg-blue-800 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-900 transition-colors mb-2 md:mb-0">Unduh Sertifikat (JPEG)</button>
                <button onclick="window.print()" class="flex-1 bg-gray-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-gray-700 transition-colors">Cetak Sertifikat</button>
            </div>
        </section>
        
    </main>

    <footer class="bg-gray-800 text-white text-center p-4 mt-10 no-print">
        <p>&copy; 2025 English for Kids Fun Learning. Dibuat dengan ‚ù§Ô∏è.</p>
    </footer>

    <script>
        // --- Game Logic ---
        const clueWordDiv = document.getElementById('clue-word');
        const answerInput = document.getElementById('answer-input');
        const checkBtn = document.getElementById('check-btn');
        const feedbackMessage = document.getElementById('feedback-message');
        const nextBtn = document.getElementById('next-btn');
        const questions = [
            { indonesian: 'apel', answer: 'apple' }, { indonesian: 'kucing', answer: 'cat' },
            { indonesian: 'pensil', answer: 'pencil' }, { indonesian: 'biru', answer: 'blue' },
            { indonesian: 'keluarga', answer: 'family' }, { indonesian: 'buku', answer: 'book' }
        ];
        let currentQuestionIndex = 0;
        let correctlyAnswered = new Set();
        let alertShown = false;

        function loadQuestion() {
            clueWordDiv.textContent = questions[currentQuestionIndex].indonesian;
            answerInput.value = '';
            feedbackMessage.textContent = '';
            nextBtn.classList.add('hidden');
            answerInput.disabled = false;
            checkBtn.disabled = false;
            answerInput.focus();
        }

        function checkAnswer() {
             const userAnswer = answerInput.value.trim().toLowerCase();
            if (userAnswer === questions[currentQuestionIndex].answer) {
                feedbackMessage.textContent = 'Benar! üéâ';
                feedbackMessage.style.color = 'green';
                nextBtn.classList.remove('hidden');
                answerInput.disabled = true;
                checkBtn.disabled = true;
                
                correctlyAnswered.add(currentQuestionIndex);

                // Cek jika semua soal sudah dijawab benar
                if (correctlyAnswered.size === questions.length && !alertShown) {
                    Swal.fire({
                        title: 'Hebat!',
                        text: 'Kamu berhasil menjawab semua pertanyaan dengan benar!',
                        icon: 'success',
                        confirmButtonText: 'Keren!'
                    });
                    alertShown = true; // Tandai bahwa alert sudah muncul
                }

            } else {
                feedbackMessage.textContent = 'Salah, coba lagi!';
                feedbackMessage.style.color = 'red';
            }
        }
        checkBtn.addEventListener('click', checkAnswer);
        answerInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') checkAnswer(); });
        nextBtn.addEventListener('click', () => {
            currentQuestionIndex = (currentQuestionIndex + 1) % questions.length;
            loadQuestion();
        });
        loadQuestion();

        // --- Certificate Logic ---
        const studentNameInput = document.getElementById('student-name-input');
        const schoolNameInput = document.getElementById('school-name-input');
        const headmasterNameInput = document.getElementById('headmaster-name-input');
        const teacherNameInput = document.getElementById('teacher-name-input');
        const generateCertBtn = document.getElementById('generate-cert-btn');
        
        const certStudentName = document.getElementById('cert-student-name');
        const certSchoolName = document.getElementById('cert-school-name');
        const certHeadmasterName = document.getElementById('cert-headmaster-name');
        const certTeacherName = document.getElementById('cert-teacher-name');
        
        const downloadCertBtn = document.getElementById('download-cert-btn');
        const certificateElement = document.getElementById('certificate');

        function updateCertificate() {
            // --- UPDATED LOGIC ---
            const studentName = studentNameInput.value.trim() || "[ Nama Murid ]";
            certStudentName.textContent = studentName;
            
            const nameLength = studentName.length;

            // Hapus kelas ukuran font yang ada untuk menghindari konflik
            certStudentName.classList.remove('text-9xl', 'text-8xl', 'text-7xl', 'text-6xl', 'text-5xl');

            // Tentukan kelas font baru berdasarkan panjang nama
            if (nameLength <= 15) {
                certStudentName.classList.add('text-9xl'); // Ukuran terbesar
            } else if (nameLength <= 20) {
                certStudentName.classList.add('text-8xl');
            } else if (nameLength <= 25) {
                certStudentName.classList.add('text-7xl');
            } else if (nameLength <= 30) {
                certStudentName.classList.add('text-6xl');
            } else {
                certStudentName.classList.add('text-5xl'); // Ukuran terkecil
            }

            // Kembalikan ke default jika input kosong
            if (studentName === "[ Nama Murid ]") {
                 certStudentName.classList.add('text-9xl');
            }
            // --- END OF UPDATED LOGIC ---

            certSchoolName.textContent = schoolNameInput.value.trim() || "[ Nama Sekolah ]";
            certHeadmasterName.textContent = headmasterNameInput.value.trim() || "[ Nama Kepala Sekolah ]";
            certTeacherName.textContent = teacherNameInput.value.trim() || "[ Nama Guru ]";
        }


        generateCertBtn.addEventListener('click', updateCertificate);

        downloadCertBtn.addEventListener('click', () => {
            downloadCertBtn.textContent = 'Sedang memproses...';
            downloadCertBtn.disabled = true;
            
            // Panggil fungsi update sekali lagi untuk memastikan nama panjang pun tergambar dengan benar
            updateCertificate();

            html2canvas(certificateElement, {
                useCORS: true,
                // Tingkatkan skala untuk resolusi lebih tinggi & ukuran file lebih besar
                scale: 3 
            }).then(canvas => {
                const link = document.createElement('a');
                const studentName = studentNameInput.value.trim().replace(/ /g, '_') || 'english-explorer';
                link.download = `sertifikat-${studentName}.jpeg`;
                // Atur kualitas JPEG ke maksimum (1.0)
                link.href = canvas.toDataURL('image/jpeg', 1.0);
                link.click();
                
                downloadCertBtn.textContent = 'Unduh Sertifikat (JPEG)';
                downloadCertBtn.disabled = false;
            }).catch(err => {
                console.error('Oops, something went wrong!', err);
                downloadCertBtn.textContent = 'Gagal, coba lagi';
                downloadCertBtn.disabled = false;
            });
        });
    </script>
</body>
</html>
